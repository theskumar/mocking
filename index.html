<!DOCTYPE html><html><head>
<title>Mocking in Python - Saurabh</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<link rel="stylesheet" href="css/main.css"></head><body><textarea id="source">
name: inverse
layout: true
class: center, middle, inverse
---
# Mocking in Python
saurabh-kumar.com/mocking

---
layout: false
class: middle
.pull-left[
![](img/test-your-code.jpg)
]
.pull-right[
## Testing
- Prevent bugs
- Prevent regressions
- If not crucial, it's important
]
???
- this talk going to include a lot of tests
- If not crucial atleast important. 
- unit tests, integration tests, or any brand new test.
- defend us against bugs
- save us during regressions
- and save us from going to office on weekends.
---
class: center, middle, inverse
# Let's Begin, Part 1
???
- Let's begin with our journey
- understand few things about mock
- and how to use it
---
class: center, middle, inverse
# Mock simulates <br><br>.red[the looks and behaviour] of real objects.
???
- Mocking means creating objects 
- that simulates the looks and behaviour of real objects.
- in real world, test can include a lot of complexity
- and dependencies
- In order to isolate the object we can mock all the other real objects
---
class: center, middle
![](img/mock-eg1.png)
---
class: center, middle
.pull-left[
## Real
![](img/mock-eg2.2.png)
]
.pull-right[
## Mock
![](img/mock-eg2.1.png)
]
???
- lost a hell lot of gadgets
- 2nd, it can't cut, it's fake
- As with all the analogies, they are very easy to understand 
- but they are not 100% accurate.
---
class: center, middle, inverse
# Mocks != Stub
???
- might heard words like dummies, fakes, stubs
- They are somewhat similar in a way
---
class: middle
## Stubs
refers to writing classes or functions but not yet implementing them or have a predetermined behaviour.
```
class Foo(object):
  def bar(self):
    pass

  def tank(self):
    return 'bla bla bla'
```
???
- stubs refers to writing classes or functions but not yet implementing them or have a predetermined behaviour.
- Stub is simple fake object. It just makes sure test runs smoothly.
- Mock is smarter stub. You verify Your test passes through it.
---
class: middle
.pull-left[
## Stubs
- Setup
- Test
- Verify State
- TearDown
]
.pull-right[
]
---
class: middle
.pull-left[
## Stubs
- Setup
- Test
- Verify State
- TearDown
]
.pull-right[
## Mocks
- Setup
- .red[Setup Expectations]
- Test
- .red[Verify Expectations]
- Verify State
- TearDown
]
---
class: middle
# Mock
```python
>>> from mock import Mock
>>> m = Mock()
>>> m.foo = 1
>>> m.foo
1
>>> m.bar
<Mock name='mock.bar' id='4593003768'>
```
---
## Good Mocks
---
.left-column[
## Good Mocks
]
.right-column[
## System calls
```python
with patch.dict('os.environ', {'ANDROID_ARGS': ''}):
  pf = Platform()
  self.AssertTrue(pf == 'Android')
```
]
---
## Streams
```python
@mock.patch('sys.stdout', new_callable=six.StringIO)
def test_print_live_refs_empty(self, stdout):
  trackref.print_live_ref()
  self.assertEqual(stdout.getvalue(), 'Live References\n\n\n')
```
---
## Networking
```python
@patch('sys.stdout', new_callable=six.StringIO)
def test_print_live_refs_empty(self, stdout):
  trackref.print_live_ref()
  self.assertEqual(stdout.getvalue(), 'Live References\n\n\n')
```
---
## IO operations
---
## Clocks, time, timezones

</textarea>
<script src='js/remark.lastest.min.js'></script>
<script> 
var hljs = remark.highlighter.engine;
var slideshow = remark.create({
    highlightStyle: 'monokai',
    highlightLanguage: 'remark',
    highlightLines: true
  }) ;
</script>
</body></html>
